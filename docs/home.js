/*! For license information please see home.js.LICENSE.txt */
!function(){"use strict";var e={};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(){n=function(){return o};var e,o={},r=Object.prototype,a=r.hasOwnProperty,c="function"==typeof Symbol?Symbol:{},i=c.iterator||"@@iterator",s=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function u(e,t,n,o){return Object.defineProperty(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o})}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function d(t,n,o,r){var a=n&&n.prototype instanceof h?n:h,c=Object.create(a.prototype);return u(c,"_invoke",function(t,n,o){var r=1;return function(a,c){if(3===r)throw Error("Generator is already running");if(4===r){if("throw"===a)throw c;return{value:e,done:!0}}for(o.method=a,o.arg=c;;){var i=o.delegate;if(i){var s=E(i,o);if(s){if(s===p)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(1===r)throw r=4,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=3;var l=f(t,n,o);if("normal"===l.type){if(r=o.done?4:2,l.arg===p)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(r=4,o.method="throw",o.arg=l.arg)}}}(t,o,new O(r||[])),!0),c}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}o.wrap=d;var p={};function h(){}function v(){}function m(){}var y={};u(y,i,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(C([])));w&&w!==r&&a.call(w,i)&&(y=w);var x=m.prototype=h.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,n){function o(r,c,i,s){var l=f(e[r],e,c);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==t(d)&&a.call(d,"__await")?n.resolve(d.__await).then((function(e){o("next",e,i,s)}),(function(e){o("throw",e,i,s)})):n.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return o("throw",e,i,s)}))}s(l.arg)}var r;u(this,"_invoke",(function(e,t){function a(){return new n((function(n,r){o(e,t,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function E(t,n){var o=n.method,r=t.i[o];if(r===e)return n.delegate=null,"throw"===o&&t.i.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=f(r,t.i,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,p;var c=a.arg;return c?c.done?(n[t.r]=c.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function k(e){this.tryEntries.push(e)}function L(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function O(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function C(n){if(null!=n){var o=n[i];if(o)return o.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,c=function t(){for(;++r<n.length;)if(a.call(n,r))return t.value=n[r],t.done=!1,t;return t.value=e,t.done=!0,t};return c.next=c}}throw new TypeError(t(n)+" is not iterable")}return v.prototype=m,u(x,"constructor",m),u(m,"constructor",v),v.displayName=u(m,l,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,l,"GeneratorFunction")),e.prototype=Object.create(x),e},o.awrap=function(e){return{__await:e}},b(S.prototype),u(S.prototype,s,(function(){return this})),o.AsyncIterator=S,o.async=function(e,t,n,r,a){void 0===a&&(a=Promise);var c=new S(d(e,t,n,r),a);return o.isGeneratorFunction(t)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},b(x),u(x,l,"Generator"),u(x,i,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),o.keys=function(e){var t=Object(e),n=[];for(var o in t)n.unshift(o);return function e(){for(;n.length;)if((o=n.pop())in t)return e.value=o,e.done=!1,e;return e.done=!0,e}},o.values=C,O.prototype={constructor:O,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(e){c.type="throw",c.arg=t,n.next=e}for(var r=n.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],c=a[4],i=this.prev,s=a[1],l=a[2];if(-1===a[0])return o("end"),!1;if(!s&&!l)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=i){if(i<s)return this.method="next",this.arg=e,o(s),!0;if(i<l)return o(l),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o[0]>-1&&o[0]<=this.prev&&this.prev<o[2]){var r=o;break}}r&&("break"===e||"continue"===e)&&r[0]<=t&&t<=r[2]&&(r=null);var a=r?r[4]:{};return a.type=e,a.arg=t,r?(this.method="next",this.next=r[2],p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),L(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var o=n[4];if("throw"===o.type){var r=o.arg;L(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,o){return this.delegate={i:C(t),r:n,n:o},"next"===this.method&&(this.arg=e),p}},o}function o(e,t,n,o,r,a,c){try{var i=e[a](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(o,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var c=e.apply(t,n);function i(e){o(c,r,a,i,s,"next",e)}function s(e){o(c,r,a,i,s,"throw",e)}i(void 0)}))}}e.d=function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var a,c="http://localhost:3001",i=[];function s(){return s=r(n().mark((function e(){var t,o,a,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout((function(){Office.context.mailbox.item&&Office.context.mailbox.item.itemType===Office.MailboxEnums.ItemType.Message&&(Office.context.mailbox.item.body.getTypeAsync?console.log("Compose mode"):console.log("Read mode"));var e=Office.context.mailbox.item;e.itemId,console.log(e.conversationId)}),3e3),t=document.querySelector(".custom-select"),o=document.querySelector(".selected-text"),a=document.querySelector(".search-input"),i=document.querySelectorAll(".option"),t.addEventListener("click",(function(e){e.target.closest(".search-input")||(t.classList.toggle("open"),t.classList.contains("open")&&a.focus())})),document.addEventListener("click",(function(e){t.contains(e.target)||t.classList.remove("open")})),a.addEventListener("input",(function(e){var t=e.target.value.toLowerCase();i.forEach((function(e){var n=e.textContent.toLowerCase();e.classList.toggle("hidden",!n.includes(t))}))})),i.forEach((function(e){e.addEventListener("click",(function(n){n.stopPropagation(),e.dataset.value,o.textContent=e.textContent,i.forEach((function(e){return e.classList.remove("selected")})),e.classList.add("selected"),t.classList.remove("open"),a.value="",i.forEach((function(e){return e.classList.remove("hidden")}))}))})),document.querySelector(".generate-btn").addEventListener("click",function(){var e=r(n().mark((function e(t){var o,a,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),"Select a tone"==document.querySelector(".selected-text").textContent?p("Select tone to continue."):""==document.querySelector(".input-text").value?p("Fill prompt to continue."):(s=void 0,(s=document.querySelector(".generate-btn")).disabled=!0,s.innerHTML='Generating... <span class="emoji">⚡</span>',(o=new Headers).append("Content-Type","application/json"),o.append("Authorization","Bearer ".concat(localStorage.getItem("access_token"))),a=JSON.stringify({model:"gpt-4o",temperature:.7,messages:[{role:"system",content:"You are an AI assistant that writes highly professional and structured emails with a ".concat(document.querySelector(".selected-text").textContent," tone.")},{role:"user",content:document.querySelector(".input-text").value},{role:"user",content:"Exclude Subject from email only email body is required"}]}),i={method:"POST",headers:o,body:a,redirect:"follow"},fetch("".concat(c,"/openai"),i).then(function(){var e=r(n().mark((function e(t){var o,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=5;break}return e.next=3,t.text();case 3:throw o=e.sent,new Error("HTTP error! Status: ".concat(t.status,", Message: ").concat(o));case 5:return e.prev=5,e.next=8,t.json();case 8:r=e.sent,console.log("Success:",r),d(r.content),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),new Error("Failed to parse JSON: "+e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e),e.message.includes("Invalid token")?(p("Session expired."),setTimeout((function(){localStorage.removeItem("access_token"),localStorage.removeItem("userLoggedIn"),window.location.href="login.html"}),1500)):p("Something went wrong.")})).finally((function(){l()})));case 2:case"end":return e.stop()}var s}),e)})));return function(t){return e.apply(this,arguments)}}());case 11:case"end":return e.stop()}}),e)}))),s.apply(this,arguments)}function l(){var e=document.querySelector(".generate-btn");e.disabled=!1,e.innerHTML='Generate Response <span class="emoji">✨</span>'}function u(){return u=r(n().mark((function e(){var t,o,s,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Office.context.mailbox.item,a=t.conversationId,(o=new Headers).append("Content-Type","application/json"),o.append("Authorization","Bearer ".concat(localStorage.getItem("access_token"))),s=JSON.stringify({thread_id:decodeURIComponent(t.conversationId)}),l={method:"POST",headers:o,body:s,redirect:"follow"},fetch("".concat(c,"/get-data"),l).then((function(e){return e.ok?e.json():e.text().then((function(t){throw new Error("HTTP error ".concat(e.status,": ").concat(t))}))})).then(function(){var e=r(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t),i=t.templates,o=t,c=void 0,s=void 0,l=void 0,u=void 0,f=void 0,(f=document.createElement("DIV")).style.position="sticky",f.innerHTML='<div><nav class="top-nav">\n        <ul class="nav-list">\n            <li class="nav-item">\n                '.concat(null!=o.emails&&o.emails.length>0?'\n                <button class="nav-button menu-sources">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">\n                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9z"/>\n                        <polyline points="9 22 9 12 15 12 15 22"/>\n                    </svg>\n                    <span>Sources</span>\n                </button>':'<button class="nav-button menu-compose">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">\n                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9z"/>\n                        <polyline points="9 22 9 12 15 12 15 22"/>\n                    </svg>\n                    <span>Compose</span>\n                </button>','\n            </li>\n            <li class="nav-item">\n                <button class="nav-button menu-iterate">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">\n                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>\n                        <line x1="16" y1="2" x2="16" y2="6"/>\n                        <line x1="8" y1="2" x2="8" y2="6"/>\n                        <line x1="3" y1="10" x2="21" y2="10"/>\n                    </svg>\n                    <span>Iterate</span>\n                </button>\n            </li>\n            <li class="nav-item">\n                <button class="nav-button menu-templates">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">\n                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>\n                        <polyline points="14 2 14 8 20 8"></polyline>\n                        <line x1="16" y1="13" x2="8" y2="13"></line>\n                        <line x1="16" y1="17" x2="8" y2="17"></line>\n                        <polyline points="10 9 9 9 8 9"></polyline>\n                    </svg>\n                    <span>Templates</span>\n                </button>\n                <div class="documentation-popup">\n                    <div class="search-container">\n                        <input type="text" class="doc-search" placeholder="Search template...">\n                    </div>\n                    <div class="doc-list">\n                        ').concat(o&&o.templates.map((function(e){return'\n                            <div class="doc-item" data-template-id="'.concat(e.id,'">').concat(e.name,"</div>\n                        ")})).join(""),'\n                    </div>\n                    <div class="doc-footer">\n                        <a href="#" class="doc-link">Alles weergeven</a>\n                        <a href="#" class="doc-link">Nieuwe aanmaken</a>\n                    </div>\n                </div>\n            </li>\n            <li class="nav-item">\n                ').concat(null!=o.emails&&o.emails.length>0?'\n                <div class="nav-button" id="menuCustomA">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">\n                        <circle cx="12" cy="12" r="10"/>\n                        <circle cx="12" cy="12" r="6"/>\n                        <circle cx="12" cy="12" r="2"/>\n                    </svg>\n                    <span>'.concat(o.emails[0].hoa,"</span>\n                </div>"):"",'\n            </li>\n            <li class="nav-item">\n                ').concat(null!=o.emails&&o.emails.length>0?'\n                <div class="nav-button" id="menuCustomB">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">\n                        <circle cx="12" cy="12" r="10"/>\n                        <circle cx="12" cy="12" r="6"/>\n                        <circle cx="12" cy="12" r="2"/>\n                    </svg>\n                    <span>'.concat(o.emails[0].sensitivity,"</span>\n                </div>"):"",'\n            </li>\n        </ul>\n\n        <div class="right-section">\n          <label class="nav-button">\n              <input type="checkbox" class="checkbox-input menu=logbook">\n              <span class="checkbox-text">Logboek</span>\n          </label>\n          <label class="nav-button">\n              <input type="checkbox" class="checkbox-input menu-follow">\n              <span class="checkbox-text">Volgen</span>\n          </label>\n        </div>\n    </nav></div>'),document.querySelector(".nav-section").appendChild(f),(u=document.querySelector(".content-loader"))&&u.remove(),document.querySelectorAll(".doc-search").forEach((function(e){e.addEventListener("input",(function(e){var t=e.target.value.toLowerCase();document.querySelectorAll(".doc-item").forEach((function(e){var n=e.textContent.toLowerCase();e.style.display=n.includes(t)?"block":"none"}))}))})),document.addEventListener("click",(function(e){try{var t=document.querySelectorAll(".documentation-popup"),n=document.querySelectorAll(".menu-templates");t.forEach((function(t){n.forEach((function(n){t.contains(e.target)||n.contains(e.target)||t.classList.remove("show")}))}))}catch(e){console.log(e)}})),document.querySelectorAll(".menu-templates").forEach((function(e,t){var n=document.querySelectorAll(".documentation-popup")[t];e.addEventListener("mouseenter",(function(){n.classList.add("show")})),n.addEventListener("mouseleave",(function(){n.classList.remove("show")}))})),null===(c=document.querySelector(".menu-sources"))||void 0===c||c.addEventListener("click",(function(e){a?window.open("https://agent.triple.blue/chat?threadId=".concat(a),"_blank"):v()})),null===(s=document.querySelector(".menu-compose"))||void 0===s||s.addEventListener("click",(function(e){document.querySelector('button[data-ext="genAI"]').click()})),null===(l=document.querySelector(".menu-iterate"))||void 0===l||l.addEventListener("click",(function(e){a?window.open("https://agent.triple.blue/chat?threadId=".concat(a),"_blank"):v()})),document.querySelectorAll(".doc-item").forEach((function(e){e.addEventListener("click",(function(){!function(e,t){var n=(i||[]).find((function(t){return t.id===e}));t(n)}(parseInt(e.getAttribute("data-template-id"),10),function(){var e=r(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,d(t.body.replace(/(\r\n|\n|\r)/g,"<br>"));case 3:e.next=6;break;case 5:console.log("Template not found");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}));case 3:case"end":return e.stop()}var o,c,s,l,u,f}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e),e.message.includes("Invalid token")?(p("Session expired."),setTimeout((function(){localStorage.removeItem("access_token"),localStorage.removeItem("userLoggedIn"),window.location.href="login.html"}),1500)):p("Something went wrong.")}));case 8:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return(f=r(n().mark((function e(t){var o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=t.replace(/\n/g,"<br>"),Office.context.mailbox.item.body.setSelectedDataAsync(o,{coercionType:Office.CoercionType.Html},(function(e){e.status===Office.AsyncResultStatus.Succeeded?console.log("Text inserted successfully."):console.error("Error inserting text:",e.error.message)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",n=document.querySelector(".notification");n&&n.remove();var o=document.createElement("div");o.className="notification ".concat(t);var r=document.createElement("span");r.className="notification-icon",r.textContent="";var a=document.createElement("span");a.className="notification-message",a.textContent=e;var c=document.createElement("button");c.className="notification-close",c.textContent="×",o.appendChild(r),o.appendChild(a),o.appendChild(c),document.body.appendChild(o),requestAnimationFrame((function(){o.classList.add("show")}));var i=setTimeout((function(){h(o)}),5e3);c.addEventListener("click",(function(){clearTimeout(i),h(o)}))}function h(e){e.classList.remove("show"),setTimeout((function(){e.remove()}),300)}function v(){localStorage.removeItem("access_token"),localStorage.removeItem("userLoggedIn"),window.location.href="login.html"}Office.onReady((function(e){e.host===Office.HostType.Outlook&&(function(){u.apply(this,arguments)}(),function(){s.apply(this,arguments)}())}))}();
//# sourceMappingURL=home.js.map