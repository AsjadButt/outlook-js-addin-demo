/*! For license information please see home.js.LICENSE.txt */
!function(){"use strict";var t="http://localhost:3001";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(){n=function(){return o};var t,o={},r=Object.prototype,a=r.hasOwnProperty,c="function"==typeof Symbol?Symbol:{},i=c.iterator||"@@iterator",s=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function u(t,e,n,o){return Object.defineProperty(t,e,{value:n,enumerable:!o,configurable:!o,writable:!o})}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function d(e,n,o,r){var a=n&&n.prototype instanceof h?n:h,c=Object.create(a.prototype);return u(c,"_invoke",function(e,n,o){var r=1;return function(a,c){if(3===r)throw Error("Generator is already running");if(4===r){if("throw"===a)throw c;return{value:t,done:!0}}for(o.method=a,o.arg=c;;){var i=o.delegate;if(i){var s=E(i,o);if(s){if(s===p)continue;return s}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if(1===r)throw r=4,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);r=3;var l=f(e,n,o);if("normal"===l.type){if(r=o.done?4:2,l.arg===p)continue;return{value:l.arg,done:o.done}}"throw"===l.type&&(r=4,o.method="throw",o.arg=l.arg)}}}(e,o,new C(r||[])),!0),c}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}o.wrap=d;var p={};function h(){}function v(){}function m(){}var y={};u(y,i,(function(){return this}));var g=Object.getPrototypeOf,x=g&&g(g(T([])));x&&x!==r&&a.call(x,i)&&(y=x);var w=m.prototype=h.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,n){function o(r,c,i,s){var l=f(t[r],t,c);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==e(d)&&a.call(d,"__await")?n.resolve(d.__await).then((function(t){o("next",t,i,s)}),(function(t){o("throw",t,i,s)})):n.resolve(d).then((function(t){u.value=t,i(u)}),(function(t){return o("throw",t,i,s)}))}s(l.arg)}var r;u(this,"_invoke",(function(t,e){function a(){return new n((function(n,r){o(t,e,n,r)}))}return r=r?r.then(a,a):a()}),!0)}function E(e,n){var o=n.method,r=e.i[o];if(r===t)return n.delegate=null,"throw"===o&&e.i.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==o&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+o+"' method")),p;var a=f(r,e.i,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,p;var c=a.arg;return c?c.done?(n[e.r]=c.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function k(t){this.tryEntries.push(t)}function L(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function C(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function T(n){if(null!=n){var o=n[i];if(o)return o.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,c=function e(){for(;++r<n.length;)if(a.call(n,r))return e.value=n[r],e.done=!1,e;return e.value=t,e.done=!0,e};return c.next=c}}throw new TypeError(e(n)+" is not iterable")}return v.prototype=m,u(w,"constructor",m),u(m,"constructor",v),v.displayName=u(m,l,"GeneratorFunction"),o.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,l,"GeneratorFunction")),t.prototype=Object.create(w),t},o.awrap=function(t){return{__await:t}},b(S.prototype),u(S.prototype,s,(function(){return this})),o.AsyncIterator=S,o.async=function(t,e,n,r,a){void 0===a&&(a=Promise);var c=new S(d(t,e,n,r),a);return o.isGeneratorFunction(e)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},b(w),u(w,l,"Generator"),u(w,i,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),o.keys=function(t){var e=Object(t),n=[];for(var o in e)n.unshift(o);return function t(){for(;n.length;)if((o=n.pop())in e)return t.value=o,t.done=!1,t;return t.done=!0,t}},o.values=T,C.prototype={constructor:C,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(t){c.type="throw",c.arg=e,n.next=t}for(var r=n.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],c=a[4],i=this.prev,s=a[1],l=a[2];if(-1===a[0])return o("end"),!1;if(!s&&!l)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=i){if(i<s)return this.method="next",this.arg=t,o(s),!0;if(i<l)return o(l),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o[0]>-1&&o[0]<=this.prev&&this.prev<o[2]){var r=o;break}}r&&("break"===t||"continue"===t)&&r[0]<=e&&e<=r[2]&&(r=null);var a=r?r[4]:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r[2],p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),L(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var o=n[4];if("throw"===o.type){var r=o.arg;L(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={i:T(e),r:n,n:o},"next"===this.method&&(this.arg=t),p}},o}function o(t,e,n,o,r,a,c){try{var i=t[a](c),s=i.value}catch(t){return void n(t)}i.done?e(s):Promise.resolve(s).then(o,r)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var c=t.apply(e,n);function i(t){o(c,r,a,i,s,"next",t)}function s(t){o(c,r,a,i,s,"throw",t)}i(void 0)}))}}var a,c=[];function i(){return i=r(n().mark((function e(){var o,a,c,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout((function(){Office.context.mailbox.item&&Office.context.mailbox.item.itemType===Office.MailboxEnums.ItemType.Message&&(Office.context.mailbox.item.body.getTypeAsync?console.log("Compose mode"):console.log("Read mode"));var t=Office.context.mailbox.item;t.itemId,console.log(t.conversationId)}),3e3),o=document.querySelector(".custom-select"),a=document.querySelector(".selected-text"),c=document.querySelector(".search-input"),i=document.querySelectorAll(".option"),o.addEventListener("click",(function(t){t.target.closest(".search-input")||(o.classList.toggle("open"),o.classList.contains("open")&&c.focus())})),document.addEventListener("click",(function(t){o.contains(t.target)||o.classList.remove("open")})),c.addEventListener("input",(function(t){var e=t.target.value.toLowerCase();i.forEach((function(t){var n=t.textContent.toLowerCase();t.classList.toggle("hidden",!n.includes(e))}))})),i.forEach((function(t){t.addEventListener("click",(function(e){e.stopPropagation(),t.dataset.value,a.textContent=t.textContent,i.forEach((function(t){return t.classList.remove("selected")})),t.classList.add("selected"),o.classList.remove("open"),c.value="",i.forEach((function(t){return t.classList.remove("hidden")}))}))})),document.querySelector(".generate-btn").addEventListener("click",function(){var e=r(n().mark((function e(o){var a,c,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.preventDefault(),"Select a tone"==document.querySelector(".selected-text").textContent?f("Select tone to continue."):""==document.querySelector(".input-text").value?f("Fill prompt to continue."):(l=void 0,(l=document.querySelector(".generate-btn")).disabled=!0,l.innerHTML='Generating... <span class="emoji">⚡</span>',(a=new Headers).append("Content-Type","application/json"),a.append("Authorization","Bearer ".concat(localStorage.getItem("access_token"))),c=JSON.stringify({model:"gpt-4o",temperature:.7,messages:[{role:"system",content:"You are an AI assistant that writes highly professional and structured emails with a ".concat(document.querySelector(".selected-text").textContent," tone.")},{role:"user",content:document.querySelector(".input-text").value},{role:"user",content:"Exclude Subject from email only email body is required"}]}),i={method:"POST",headers:a,body:c,redirect:"follow"},fetch("".concat(t,"/openai"),i).then(function(){var t=r(n().mark((function t(e){var o,r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ok){t.next=5;break}return t.next=3,e.text();case 3:throw o=t.sent,new Error("HTTP error! Status: ".concat(e.status,", Message: ").concat(o));case 5:return t.prev=5,t.next=8,e.json();case 8:r=t.sent,console.log("Success:",r),u(r.content),t.next=16;break;case 13:throw t.prev=13,t.t0=t.catch(5),new Error("Failed to parse JSON: "+t.t0.message);case 16:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){console.log(t),t.message.includes("Invalid token")?(f("Session expired."),setTimeout((function(){localStorage.removeItem("access_token"),localStorage.removeItem("userLoggedIn"),window.location.href="login.html"}),1500)):f("Something went wrong.")})).finally((function(){s()})));case 2:case"end":return e.stop()}var l}),e)})));return function(t){return e.apply(this,arguments)}}());case 11:case"end":return e.stop()}}),e)}))),i.apply(this,arguments)}function s(){var t=document.querySelector(".generate-btn");t.disabled=!1,t.innerHTML='Generate Response <span class="emoji">✨</span>'}function l(){return l=r(n().mark((function e(){var o,i,s,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=Office.context.mailbox.item,a=o.conversationId,(i=new Headers).append("Content-Type","application/json"),i.append("Authorization","Bearer ".concat(localStorage.getItem("access_token"))),s=JSON.stringify({thread_id:decodeURIComponent(o.conversationId)}),l={method:"POST",headers:i,body:s,redirect:"follow"},fetch("".concat(t,"/get-data"),l).then((function(t){return t.ok?t.json():t.text().then((function(e){throw new Error("HTTP error ".concat(t.status,": ").concat(e))}))})).then(function(){var t=r(n().mark((function t(e){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log(e),c=e.templates,o=e,i=void 0,s=void 0,l=void 0,d=void 0,f=void 0,(f=document.createElement("DIV")).style.position="sticky",f.innerHTML='<div><nav class="top-nav">\n        <ul class="nav-list">\n            <li class="nav-item">\n                '.concat(null!=o.emails&&o.emails.length>0?'\n                <button class="nav-button menu-sources">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">\n                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9z"/>\n                        <polyline points="9 22 9 12 15 12 15 22"/>\n                    </svg>\n                    <span>Sources</span>\n                </button>':'<button class="nav-button menu-compose">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">\n                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9z"/>\n                        <polyline points="9 22 9 12 15 12 15 22"/>\n                    </svg>\n                    <span>Compose</span>\n                </button>','\n            </li>\n            <li class="nav-item">\n                <button class="nav-button menu-iterate">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">\n                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>\n                        <line x1="16" y1="2" x2="16" y2="6"/>\n                        <line x1="8" y1="2" x2="8" y2="6"/>\n                        <line x1="3" y1="10" x2="21" y2="10"/>\n                    </svg>\n                    <span>Iterate</span>\n                </button>\n            </li>\n            <li class="nav-item">\n                <button class="nav-button menu-templates">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">\n                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>\n                        <polyline points="14 2 14 8 20 8"></polyline>\n                        <line x1="16" y1="13" x2="8" y2="13"></line>\n                        <line x1="16" y1="17" x2="8" y2="17"></line>\n                        <polyline points="10 9 9 9 8 9"></polyline>\n                    </svg>\n                    <span>Templates</span>\n                </button>\n                <div class="documentation-popup">\n                    <div class="search-container">\n                        <input type="text" class="doc-search" placeholder="Search template...">\n                    </div>\n                    <div class="doc-list">\n                        ').concat(o&&o.templates.map((function(t){return'\n                            <div class="doc-item" data-template-id="'.concat(t.id,'">').concat(t.name,"</div>\n                        ")})).join(""),'\n                    </div>\n                    <div class="doc-footer">\n                        <a href="#" class="doc-link">Alles weergeven</a>\n                        <a href="#" class="doc-link">Nieuwe aanmaken</a>\n                    </div>\n                </div>\n            </li>\n            <li class="nav-item">\n                ').concat(null!=o.emails&&o.emails.length>0?'\n                <div class="nav-button" id="menuCustomA">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">\n                        <circle cx="12" cy="12" r="10"/>\n                        <circle cx="12" cy="12" r="6"/>\n                        <circle cx="12" cy="12" r="2"/>\n                    </svg>\n                    <span>'.concat(o.emails[0].hoa,"</span>\n                </div>"):"",'\n            </li>\n            <li class="nav-item">\n                ').concat(null!=o.emails&&o.emails.length>0?'\n                <div class="nav-button" id="menuCustomB">\n                    <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">\n                        <circle cx="12" cy="12" r="10"/>\n                        <circle cx="12" cy="12" r="6"/>\n                        <circle cx="12" cy="12" r="2"/>\n                    </svg>\n                    <span>'.concat(o.emails[0].sensitivity,"</span>\n                </div>"):"",'\n            </li>\n        </ul>\n\n        <div class="right-section">\n          <label class="nav-button">\n              <input type="checkbox" class="checkbox-input menu=logbook">\n              <span class="checkbox-text">Logboek</span>\n          </label>\n          <label class="nav-button">\n              <input type="checkbox" class="checkbox-input menu-follow">\n              <span class="checkbox-text">Volgen</span>\n          </label>\n        </div>\n    </nav></div>'),document.querySelector(".nav-section").appendChild(f),(d=document.querySelector(".content-loader"))&&d.remove(),document.querySelectorAll(".doc-search").forEach((function(t){t.addEventListener("input",(function(t){var e=t.target.value.toLowerCase();document.querySelectorAll(".doc-item").forEach((function(t){var n=t.textContent.toLowerCase();t.style.display=n.includes(e)?"block":"none"}))}))})),document.addEventListener("click",(function(t){try{var e=document.querySelectorAll(".documentation-popup"),n=document.querySelectorAll(".menu-templates");e.forEach((function(e){n.forEach((function(n){e.contains(t.target)||n.contains(t.target)||e.classList.remove("show")}))}))}catch(t){console.log(t)}})),document.querySelectorAll(".menu-templates").forEach((function(t,e){var n=document.querySelectorAll(".documentation-popup")[e];t.addEventListener("mouseenter",(function(){n.classList.add("show")})),n.addEventListener("mouseleave",(function(){n.classList.remove("show")}))})),null===(i=document.querySelector(".menu-sources"))||void 0===i||i.addEventListener("click",(function(t){a?window.open("https://agent.triple.blue/chat?threadId=".concat(a),"_blank"):h()})),null===(s=document.querySelector(".menu-compose"))||void 0===s||s.addEventListener("click",(function(t){document.querySelector('button[data-ext="genAI"]').click()})),null===(l=document.querySelector(".menu-iterate"))||void 0===l||l.addEventListener("click",(function(t){a?window.open("https://agent.triple.blue/chat?threadId=".concat(a),"_blank"):h()})),document.querySelectorAll(".doc-item").forEach((function(t){t.addEventListener("click",(function(){!function(t,e){var n=(c||[]).find((function(e){return e.id===t}));e(n)}(parseInt(t.getAttribute("data-template-id"),10),function(){var t=r(n().mark((function t(e){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,u(e.body.replace(/(\r\n|\n|\r)/g,"<br>"));case 3:t.next=6;break;case 5:console.log("Template not found");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}));case 3:case"end":return t.stop()}var o,i,s,l,d,f}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){console.log(t),t.message.includes("Invalid token")?(f("Session expired."),setTimeout((function(){localStorage.removeItem("access_token"),localStorage.removeItem("userLoggedIn"),window.location.href="login.html"}),1500)):f("Something went wrong.")}));case 8:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function u(t){return d.apply(this,arguments)}function d(){return(d=r(n().mark((function t(e){var o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=e.replace(/\n/g,"<br>"),Office.context.mailbox.item.body.setSelectedDataAsync(o,{coercionType:Office.CoercionType.Html},(function(t){t.status===Office.AsyncResultStatus.Succeeded?console.log("Text inserted successfully."):console.error("Error inserting text:",t.error.message)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function f(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"error",n=document.querySelector(".notification");n&&n.remove();var o=document.createElement("div");o.className="notification ".concat(e);var r=document.createElement("span");r.className="notification-icon",r.textContent="";var a=document.createElement("span");a.className="notification-message",a.textContent=t;var c=document.createElement("button");c.className="notification-close",c.textContent="×",o.appendChild(r),o.appendChild(a),o.appendChild(c),document.body.appendChild(o),requestAnimationFrame((function(){o.classList.add("show")}));var i=setTimeout((function(){p(o)}),5e3);c.addEventListener("click",(function(){clearTimeout(i),p(o)}))}function p(t){t.classList.remove("show"),setTimeout((function(){t.remove()}),300)}function h(){localStorage.removeItem("access_token"),localStorage.removeItem("userLoggedIn"),window.location.href="login.html"}Office.onReady((function(t){t.host===Office.HostType.Outlook&&(function(){l.apply(this,arguments)}(),function(){i.apply(this,arguments)}())}))}();
//# sourceMappingURL=home.js.map